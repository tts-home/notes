"use strict";(self.webpackChunktts_notes=self.webpackChunktts_notes||[]).push([[7538],{1452:(e,n,o)=>{o.r(n),o.d(n,{assets:()=>a,contentTitle:()=>s,default:()=>p,frontMatter:()=>t,metadata:()=>i,toc:()=>l});var c=o(5893),r=o(1151);const t={},s="Dockerfile Collection",i={id:"cicd/docker/docker_file_collection",title:"Dockerfile Collection",description:"\u5982\u679c ENTRYPOINT / CMD \u6307\u5b9a\u7684\u811a\u672c\u4e2d\u4f7f\u7528\u4e86 nohup + & \u5b9e\u73b0\u540e\u53f0\u8fd0\u884c\uff0c\u5219 docker run \u4e0d\u53ef\u6307\u5b9a -d \u53c2\u6570\uff0c\u5426\u5219\u5bb9\u5668\u4f1a\u5728\u6267\u884c\u5b8c\u811a\u672c\u540e\u9000\u51fa\u3002",source:"@site/docs/cicd/docker/docker_file_collection.md",sourceDirName:"cicd/docker",slug:"/cicd/docker/docker_file_collection",permalink:"/notes/cicd/docker/docker_file_collection",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{},sidebar:"docs",previous:{title:"Docker Daemon",permalink:"/notes/cicd/docker/docker_daemon"},next:{title:"Docker Network",permalink:"/notes/cicd/docker/docker_network"}},a={},l=[{value:"Nacos",id:"nacos",level:2},{value:"Dockerfile",id:"dockerfile",level:3},{value:"Container",id:"container",level:3},{value:"ElasticJob",id:"elasticjob",level:2},{value:"Dockerfile",id:"dockerfile-1",level:3},{value:"Container",id:"container-1",level:3},{value:"Zookeeper",id:"zookeeper",level:2},{value:"Dockerfile",id:"dockerfile-2",level:3},{value:"Container",id:"container-2",level:3}];function d(e){const n={admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",p:"p",pre:"pre",...(0,r.a)(),...e.components};return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(n.h1,{id:"dockerfile-collection",children:"Dockerfile Collection"}),"\n",(0,c.jsx)(n.admonition,{title:"\u63d0\u793a",type:"info",children:(0,c.jsxs)(n.p,{children:["\u5982\u679c ENTRYPOINT / CMD \u6307\u5b9a\u7684\u811a\u672c\u4e2d\u4f7f\u7528\u4e86 ",(0,c.jsx)(n.code,{children:"nohup"})," + ",(0,c.jsx)(n.code,{children:"&"})," \u5b9e\u73b0\u540e\u53f0\u8fd0\u884c\uff0c\u5219 ",(0,c.jsx)(n.code,{children:"docker run"})," \u4e0d\u53ef\u6307\u5b9a ",(0,c.jsx)(n.code,{children:"-d"})," \u53c2\u6570\uff0c\u5426\u5219\u5bb9\u5668\u4f1a\u5728\u6267\u884c\u5b8c\u811a\u672c\u540e\u9000\u51fa\u3002"]})}),"\n",(0,c.jsx)(n.h2,{id:"nacos",children:"Nacos"}),"\n",(0,c.jsx)(n.h3,{id:"dockerfile",children:"Dockerfile"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-dockerfile",children:'FROM centos:8.1.1911\n# set environment\nENV MODE="cluster" \\\n    PREFER_HOST_MODE="ip"\\\n    BASE_DIR="/home/nacos" \\\n    CLASSPATH=".:/home/nacos/conf:$CLASSPATH" \\\n    CLUSTER_CONF="/home/nacos/conf/cluster.conf" \\\n    FUNCTION_MODE="all" \\\n    JAVA_HOME="/usr/lib/jvm/java-1.8.0-openjdk" \\\n    NACOS_USER="nacos" \\\n    JAVA="/usr/lib/jvm/java-1.8.0-openjdk/bin/java" \\\n    JVM_XMS="1g" \\\n    JVM_XMX="1g" \\\n    JVM_XMN="512m" \\\n    JVM_MS="128m" \\\n    JVM_MMS="320m" \\\n    NACOS_DEBUG="n" \\\n    TOMCAT_ACCESSLOG_ENABLED="false" \\\n    TIME_ZONE="Asia/Shanghai"\nARG NACOS_VERSION=2.0.3\nARG HOT_FIX_FLAG=""\nWORKDIR $BASE_DIR\nRUN yum install -y java-1.8.0-openjdk-devel && yum clean all\nCOPY nacos/ ./\nCOPY bin/docker-startup.sh bin/docker-startup.sh\nCOPY conf/application.properties conf/application.properties\n# set startup log dir\nRUN mkdir -p logs \\\n\t&& cd logs \\\n\t&& touch start.out \\\n\t&& ln -sf /dev/stdout start.out \\\n\t&& ln -sf /dev/stderr start.out\nRUN chmod +x bin/docker-startup.sh\nEXPOSE 8848\nENTRYPOINT ["bin/docker-startup.sh"]\n'})}),"\n",(0,c.jsx)(n.h3,{id:"container",children:"Container"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:"docker build -t nacos-server:2.0.3-aarch64\ndocker run -d --name nacos-server \\\n    --network docker --network-alias nacos \\\n    -e MODE=standalone \\\n    -e PREFER_HOST_MODE=hostname \\\n    -p 8848:8848 \\\n    -p 9848:9848 \\\n    -p 9849:9849 \\\n    -v /Users/tts/data/docker/nacos/log:/home/nacos/logs \\\n    -v /Users/tts/data/docker/nacos/init.d/custom.properties:/home/nacos/init.d/custom.properties \\\n    -v /Users/tts/data/docker/nacos/conf/application.properties:/home/nacos/conf/application.properties \\\n    -v /Users/tts/data/docker/nacos/conf/nacos-logback.xml:/home/nacos/conf/nacos-logback.xml \\\n    nacos-server:2.0.3-aarch64\n"})}),"\n",(0,c.jsx)(n.h2,{id:"elasticjob",children:"ElasticJob"}),"\n",(0,c.jsx)(n.h3,{id:"dockerfile-1",children:"Dockerfile"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-dockerfile",children:'FROM registry.cn-hangzhou.aliyuncs.com/tts-tech/jre_aarch64:17.0.3\nCOPY elasticjob /opt/elasticjob/\nEXPOSE 8088\nENTRYPOINT ["/opt/elasticjob/bin/start.sh"]\n'})}),"\n",(0,c.jsx)(n.h3,{id:"container-1",children:"Container"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:"docker build . -t elastic-job-ui:3.0.1\ndocker run -d --name elastic-job-ui --pull missing \\\n    -p 8088:8088 \\\n    -v /Users/tts/data/docker/elasticjob/logs/:/opt/elasticjob/logs/ \\\n    elastic-job-ui:3.0.1\n"})}),"\n",(0,c.jsx)(n.h2,{id:"zookeeper",children:"Zookeeper"}),"\n",(0,c.jsx)(n.h3,{id:"dockerfile-2",children:"Dockerfile"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-dockerfile",children:'FROM registry.cn-hangzhou.aliyuncs.com/tts-tech/jre_aarch64:17.0.3\nCOPY zookeeper /opt/zookeeper/\nEXPOSE 2181\nENTRYPOINT ["/opt/zookeeper/bin/zkServer.sh"]\nCMD ["start-foreground", "/opt/zookeeper/conf/zoo.cfg"]\n'})}),"\n",(0,c.jsx)(n.h3,{id:"container-2",children:"Container"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:"docker build . -t zookeeper:3.8.0\ndocker run -d --name zookeeper \\\n    -p 2181:2181 \\\n    -v /Users/tts/data/docker/zookeeper/data/:/opt/zookeeper/data/ \\\n    -v /Users/tts/data/docker/zookeeper/logs/:/opt/zookeeper/logs/ \\\n    -v /Users/tts/data/docker/zookeeper/zoo.cfg:/opt/zookeeper/conf/zoo.cfg \\\n    zookeeper:3.8.0\n"})})]})}function p(e={}){const{wrapper:n}={...(0,r.a)(),...e.components};return n?(0,c.jsx)(n,{...e,children:(0,c.jsx)(d,{...e})}):d(e)}},1151:(e,n,o)=>{o.d(n,{Z:()=>i,a:()=>s});var c=o(7294);const r={},t=c.createContext(r);function s(e){const n=c.useContext(t);return c.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:s(e.components),c.createElement(t.Provider,{value:n},e.children)}}}]);