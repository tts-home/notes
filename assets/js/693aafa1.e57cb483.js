"use strict";(self.webpackChunktts_notes=self.webpackChunktts_notes||[]).push([[492],{8295:(n,e,t)=>{t.r(e),t.d(e,{assets:()=>R,contentTitle:()=>i,default:()=>a,frontMatter:()=>r,metadata:()=>c,toc:()=>O});var o=t(5893),s=t(1151);const r={},i="\u624b\u52a8 deploy",c={id:"cicd/maven/custom_deploy",title:"\u624b\u52a8 deploy",description:"script",source:"@site/docs/cicd/maven/custom_deploy.md",sourceDirName:"cicd/maven",slug:"/cicd/maven/custom_deploy",permalink:"/notes/cicd/maven/custom_deploy",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{},sidebar:"docs",previous:{title:"KT Connect",permalink:"/notes/cicd/k8s/kt_connect"},next:{title:"\u81ea\u7528 settings.xml",permalink:"/notes/cicd/maven/custom_settings"}},R={},O=[{value:"script",id:"script",level:2}];function I(n){const e={code:"code",h1:"h1",h2:"h2",pre:"pre",...(0,s.a)(),...n.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(e.h1,{id:"\u624b\u52a8-deploy",children:"\u624b\u52a8 deploy"}),"\n",(0,o.jsx)(e.h2,{id:"script",children:"script"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-shell",children:'# \u9700\u5b89\u88c5Java\u8fd0\u884c\u73af\u5883\uff0cMaven\uff0c\u4e14\u76f8\u5173\u6587\u4ef6\u5728PATH\u4e0b\n# \u6307\u5b9a\u6587\u4ef6\u8def\u5f84(\u4e0d\u53ef\u4f7f\u7528\u672c\u5730\u4ed3\u5e93\uff0c\u6587\u4ef6\u8def\u5f84\u9700\u4e0e\u672c\u5730\u4ed3\u5e93\u4fdd\u6301\u4e00\u81f4\uff0c\u5373\u4f9d\u8d56\u5750\u6807\u53ef\u7528)\uff0c\u53d1\u5e03\u4ed3\u5e93id, \u53d1\u5e03\u4ed3\u5e93url\nLOCAL_REPO=/Users/tsy/Deploy\nREPOSITORY_ID_SNAPSHOT=surpath-snapshots\nREPOSITORY_URL_SNAPSHOT=http://172.16.0.109:8081/repository/maven-snapshots/\nREPOSITORY_ID_RELEASE=surpath-releases\nREPOSITORY_URL_RELEASE=http://mvn.surpath-inc.net/repository/maven-releases/\n\n# \u83b7\u53d6\u53d1\u5e03\u7c7b\u578b(\u5ffd\u7565\u5927\u5c0f\u5199)\uff0cgroupId\uff0cartifactId\uff0cversion\uff0c\u4ed3\u5e93\nTYPE=$1\nGROUP_ID=$2\nARTIFACT_ID=$3\nVERSION=$4\nREPO=$5\n\nif [ ! -n "$TYPE" ]; then\n    echo "You must specify the type"\n    exit 1\nfi\n\n# \u7c7b\u578b\u8f6c\u5c0f\u5199\nTYPE=$(echo $TYPE | tr \'[A-Z]\' \'[a-z]\')\n\nif [ ! -n "$GROUP_ID" ]; then\n    echo "You must specify the group id"\n    exit 1\nfi\n\nif [ ! -n "$ARTIFACT_ID" ]; then\n    echo "You must specify the artifact id"\n    exit 1\nfi\n\nif [ ! -n "$VERSION" ]; then\n    echo "You must specify the version"\n    exit 1\nfi\n\nif [[ -n "$REPO" ]] && [[ $REPO == "release" ]]; then\n    REPOSITORY_ID=$REPOSITORY_ID_RELEASE\n    REPOSITORY_URL=$REPOSITORY_URL_RELEASE\nelse\n    REPOSITORY_ID=$REPOSITORY_ID_SNAPSHOT\n    REPOSITORY_URL=$REPOSITORY_URL_SNAPSHOT\nfi\n\n# \u5904\u7406\u8def\u5f84\nOLD_IFS="$IFS" \nIFS="." \narr=($GROUP_ID)\nIFS="$OLD_IFS"\nWORK_DIR=$LOCAL_REPO\nfor folder in ${arr[@]} \ndo \n    WORK_DIR=$WORK_DIR/$folder\ndone\n\nWORK_DIR=$WORK_DIR/$ARTIFACT_ID\nWORK_DIR=$WORK_DIR/$VERSION\n\nFILE_NAME=$ARTIFACT_ID-$VERSION\n\nCOMMAND="mvn deploy:deploy-file"\nCOMMAND=$COMMAND" -DgroupId=$GROUP_ID -DartifactId=$ARTIFACT_ID -Dversion=$VERSION"\n\nif [ $TYPE == "jar" ]; then\n    COMMAND=$COMMAND" -Dfile=$WORK_DIR/$FILE_NAME.jar"\n    COMMAND=$COMMAND" -DpomFile=$WORK_DIR/$FILE_NAME.pom"\n    COMMAND=$COMMAND" -Dsources=$WORK_DIR/$FILE_NAME-sources.jar"\nelse\n    COMMAND=$COMMAND" -Dfile=$WORK_DIR/$FILE_NAME.pom"\nfi\n\nCOMMAND=$COMMAND" -Dpackaging=$TYPE"\nCOMMAND=$COMMAND" -DgeneratePom=false -DrepositoryId=$REPOSITORY_ID -Durl=$REPOSITORY_URL"\n\necho ">>> Start to deploy: $ARTIFACT_ID-$VERSION.$TYPE to repository: $REPOSITORY_ID $REPOSITORY_URL"\necho ">>> Execute $COMMAND"\n\n$COMMAND\n'})})]})}function a(n={}){const{wrapper:e}={...(0,s.a)(),...n.components};return e?(0,o.jsx)(e,{...n,children:(0,o.jsx)(I,{...n})}):I(n)}},1151:(n,e,t)=>{t.d(e,{Z:()=>c,a:()=>i});var o=t(7294);const s={},r=o.createContext(s);function i(n){const e=o.useContext(r);return o.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function c(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(s):n.components||s:i(n.components),o.createElement(r.Provider,{value:e},n.children)}}}]);