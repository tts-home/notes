"use strict";(self.webpackChunktts_notes=self.webpackChunktts_notes||[]).push([[2187],{1157:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>d,contentTitle:()=>o,default:()=>m,frontMatter:()=>t,metadata:()=>a,toc:()=>c});var r=n(5893),l=n(1151);const t={},o="Mysql Server Docker",a={id:"database/mysql/mysql_server_docker",title:"Mysql Server Docker",description:"\u4e0b\u8f7d MySql Server",source:"@site/docs/database/mysql/mysql_server_docker.md",sourceDirName:"database/mysql",slug:"/database/mysql/mysql_server_docker",permalink:"/notes/database/mysql/mysql_server_docker",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{},sidebar:"docs",previous:{title:"Mysql \u914d\u7f6e\u6587\u4ef6",permalink:"/notes/database/mysql/mysql.cnf"},next:{title:"h2database server",permalink:"/notes/database/other/h2"}},d={},c=[{value:"\u4e0b\u8f7d MySql Server",id:"\u4e0b\u8f7d-mysql-server",level:2},{value:"entrypoint.sh",id:"entrypointsh",level:2},{value:"Dockerfile",id:"dockerfile",level:2},{value:"Build &amp; Run",id:"build--run",level:2},{value:"root \u7528\u6237\u8bbe\u7f6e",id:"root-\u7528\u6237\u8bbe\u7f6e",level:2}];function i(e){const s={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",p:"p",pre:"pre",...(0,l.a)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(s.h1,{id:"mysql-server-docker",children:"Mysql Server Docker"}),"\n",(0,r.jsx)(s.h2,{id:"\u4e0b\u8f7d-mysql-server",children:"\u4e0b\u8f7d MySql Server"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-shell",children:"wget https://dev.mysql.com/get/Downloads/MySQL-8.0/mysql-8.0.28-linux-glibc2.17-x86_64-minimal.tar.xz\n"})}),"\n",(0,r.jsx)(s.h2,{id:"entrypointsh",children:"entrypoint.sh"}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.a,{href:"docker_entrypoint.sh",children:"Entrypoint"})}),"\n",(0,r.jsx)(s.h2,{id:"dockerfile",children:"Dockerfile"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-dockerfile",children:'FROM --platform=linux/amd64 debian:stable-slim\n\nENV PATH=/opt/mysql/bin:$PATH\nCOPY mysql-8.0.28 /opt/mysql/\nCOPY entrypoint.sh /opt/mysql/entrypoint.sh\n\nRUN groupadd -r mysql && useradd -r -g mysql mysql\nRUN apt-get update && apt-cache search libaio && apt-get install -y libaio1 numactl gosu libncurses5 && \\\n    apt-get purge -y --auto-remove -o APT::AutoRemove::RecommendsImportant=false && \\\n    rm -rf /var/lib/apt/lists/*\nRUN mkdir /docker-entrypoint-initdb.d/\n\nEXPOSE 3306 33060\n\nENTRYPOINT ["/opt/mysql/entrypoint.sh"]\nCMD ["mysqld"]\n'})}),"\n",(0,r.jsx)(s.h2,{id:"build--run",children:"Build & Run"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-shell",children:"docker build . -t mysql:8.0.28\ndocker run -d --name mysql --pull missing \\\n    --network docker_tts --network-alias mysql \\\n    -e MYSQL_RANDOM_ROOT_PASSWORD=yes \\\n    -p 3306:3306 \\\n    -v /Users/tts/data/docker/mysql/my.cnf:/opt/mysql/my.cnf \\\n    -v /Users/tts/data/docker/mysql/data:/data/mysql/data \\\n    -v /Users/tts/data/docker/mysql/log:/data/mysql/log \\\n    -v /Users/tts/data/docker/mysql/temp:/data/mysql/temp \\\n    mysql:8.0.28 --defaults-file=/opt/mysql/my.cnf\n"})}),"\n",(0,r.jsx)(s.h2,{id:"root-\u7528\u6237\u8bbe\u7f6e",children:"root \u7528\u6237\u8bbe\u7f6e"}),"\n",(0,r.jsxs)(s.admonition,{title:"\u6ce8\u610f",type:"info",children:[(0,r.jsxs)(s.p,{children:["\u5f53\u521d\u59cb\u5316\u5b8c\u6210\uff0c\u547d\u4ee4\u8f93\u51fa\u4e2d\u4f1a\u5305\u542b\u4e3a ",(0,r.jsx)(s.code,{children:"root"})," \u7528\u6237\u751f\u6210\u7684\u968f\u673a\u5bc6\u7801\uff0c\u53ef\u4ee5\u901a\u8fc7\u4e0b\u9762\u7684\u547d\u4ee4\u63d0\u53d6\u5bc6\u7801\uff1a"]}),(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-shell",children:"docker logs mysql 2>&1 | grep GENERATED\n# \u8f93\u51fa\u4e2d\u4f1a\u6253\u5370\u51fa\u5bc6\u7801\nGENERATED ROOT PASSWORD: Axegh3kAJyDLaRuBemecis&EShOs\n"})}),(0,r.jsxs)(s.p,{children:["\u5f53 ",(0,r.jsx)(s.code,{children:"server"})," \u5df2\u5c31\u7eea\uff0c\u5373\u53ef\u901a\u8fc7\u5ba2\u6237\u7aef\u8fde\u63a5\u5230 ",(0,r.jsx)(s.code,{children:"Mysql server"}),"\u3002"]}),(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-shell",children:"docker exec -it mysql mysql -u root -p\n"})}),(0,r.jsxs)(s.p,{children:["\u4ea4\u4e92\u754c\u9762\u8981\u6c42\u8f93\u5165\u5bc6\u7801\uff0c\u5373\u53ef\u8f93\u5165\u521a\u521a\u83b7\u53d6\u5230\u7684\u968f\u673a\u5bc6\u7801\uff0c\u767b\u5f55\u8fdb\u53bb\u4e4b\u540e\u5373\u53ef\u66f4\u6539 ",(0,r.jsx)(s.code,{children:"root"})," \u7528\u6237\u7684\u4fe1\u606f\uff08\u8bb0\u4f4f\u6539\u5bc6\u7801\uff09\u3002"]}),(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-sql",children:"ALTER USER CURRENT_USER() IDENTIFIED WITH caching_sha2_password BY 'password';\nFLUSH PRIVILEGES;\n"})}),(0,r.jsx)(s.p,{children:"\u5982\u679c\u63a7\u5236\u53f0\u65e5\u5fd7\u4e2d\u672a\u8f93\u51fa\u751f\u6210\u7684\u968f\u673a\u5bc6\u7801\uff0c\u53ef\u5c1d\u8bd5\u4f7f\u7528\u7a7a\u5bc6\u7801\u767b\u5f55\u3002"}),(0,r.jsxs)(s.p,{children:["\u4fee\u6539 ",(0,r.jsx)(s.code,{children:"root"})," \u7528\u6237 ",(0,r.jsx)(s.code,{children:"Host"})]}),(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-sql",children:"UPDATE mysql.user SET Host = '%' WHERE User = 'root';\nFLUSH PRIVILEGES;\n"})})]})]})}function m(e={}){const{wrapper:s}={...(0,l.a)(),...e.components};return s?(0,r.jsx)(s,{...e,children:(0,r.jsx)(i,{...e})}):i(e)}},1151:(e,s,n)=>{n.d(s,{Z:()=>a,a:()=>o});var r=n(7294);const l={},t=r.createContext(l);function o(e){const s=r.useContext(t);return r.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function a(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:o(e.components),r.createElement(t.Provider,{value:s},e.children)}}}]);